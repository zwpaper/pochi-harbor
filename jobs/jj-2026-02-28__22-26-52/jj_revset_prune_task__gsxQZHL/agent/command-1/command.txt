trap 'rm -rf /tmp/codex-secrets "$CODEX_HOME/auth.json"' EXIT TERM INT; codex exec --dangerously-bypass-approvals-and-sandbox --skip-git-repo-check --model gpt-5.3-codex --json --enable unified_exec -c model_reasoning_effort=high -- '# JJ Revset Prune Task

You are a developer migrating from Git to Jujutsu (`jj`). You are working in a repository located at `/home/user/repo`.

The current history contains a mistake: a revision with the description "temporary debug info" was accidentally created in the middle of the chain. It sits between the "initial setup" revision and your current working copy.

Your goal is to clean up this history using `jj` commands.

## Instructions

1.  **Identify the bad revision**: Use a `jj log` command with a **revset** to find the revision specifically with the description "temporary debug info".
2.  **Record the Change ID**: Save the **Change ID** (not the Commit ID) of that revision to a file named `/home/user/bad_revision_id.txt`. The file should contain *only* the Change ID string (e.g., `kkmpptxz...`).
3.  **Prune the revision**: Use the `jj abandon` command to remove this revision from the history. Observe how `jj` handles the descendant revisions.
4.  **Finalize work**: Ensure your current working copy revision has the description "clean feature" and contains a file named `status.txt` with the text content `ready`.

## Expected Outcome

*   The repository history should show "clean feature" as a direct descendant of "initial setup".
*   The "temporary debug info" revision should no longer appear in the standard log.
*   The file `/home/user/bad_revision_id.txt` must exist and contain the correct ID.
*   The file `status.txt` exists in the working copy with the correct content.
' 2>&1 </dev/null | tee /logs/agent/codex.txt