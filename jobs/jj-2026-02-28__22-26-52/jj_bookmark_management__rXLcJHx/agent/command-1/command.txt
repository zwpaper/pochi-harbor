trap 'rm -rf /tmp/codex-secrets "$CODEX_HOME/auth.json"' EXIT TERM INT; codex exec --dangerously-bypass-approvals-and-sandbox --skip-git-repo-check --model gpt-5.3-codex --json --enable unified_exec -c model_reasoning_effort=high -- 'You are a developer working in a `jj` (Jujutsu) repository located at `/home/user/repo`.
You have been working on an authentication feature.
The repository currently has a bookmark named `auth-feature` which points to the previous commit (the parent of your working copy).
Your working copy contains the latest changes for this feature.

Your task is to update the repository state to reflect the following:
1.  Set the description of your current working copy revision to `feat: refine auth logic`.
2.  Move the existing `auth-feature` bookmark to point to your current working copy revision.
3.  Create a new bookmark named `auth-backup` pointing to the parent revision (the revision `auth-feature` previously pointed to).
4.  Verify your changes by running `jj log -r "all()"` and saving the output to `/home/user/repo/repo_state.log`.

Ensure you do not modify the file contents, only the metadata (bookmarks and descriptions).
' 2>&1 </dev/null | tee /logs/agent/codex.txt